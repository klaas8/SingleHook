name: add PAT

on:
  workflow_dispatch:

jobs:
  check-repos:
    runs-on: ubuntu-latest
    steps:
      - name: Check for new repositories
        env:
          GH_TOKEN: ${{ secrets.PAT }}
        run: |
          echo "开始处理仓库列表..."
          
          # 使用 while 循环逐行读取
          gh repo list --limit 1000 --json nameWithOwner --jq '.[].nameWithOwner' | while read -r REPO; do
            echo "Processing: $REPO"
            # gh secret set PAT \
            #   --repo "$REPO" \
            #   --body "${{ secrets.PAT }}"
          done
          
          echo "处理完成"
